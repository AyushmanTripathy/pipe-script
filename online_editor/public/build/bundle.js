var app=function(){"use strict";function e(){}function t(e){return e()}function s(){return Object.create(null)}function n(e){e.forEach(t)}function r(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(e,t){e.appendChild(t)}function c(e,t,s){e.insertBefore(t,s||null)}function u(e){e.parentNode.removeChild(e)}function l(e){return document.createElement(e)}function a(){return e=" ",document.createTextNode(e);var e}function f(e,t,s,n){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s,n)}function p(e,t,s){null==s?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function h(e,t){e.value=null==t?"":t}let d;function b(e){d=e}const g=[],m=[],$=[],v=[],y=Promise.resolve();let k=!1;function w(e){$.push(e)}let _=!1;const W=new Set;function x(){if(!_){_=!0;do{for(let e=0;e<g.length;e+=1){const t=g[e];b(t),N(t.$$)}for(b(null),g.length=0;m.length;)m.pop()();for(let e=0;e<$.length;e+=1){const t=$[e];W.has(t)||(W.add(t),t())}$.length=0}while(g.length);for(;v.length;)v.pop()();k=!1,_=!1,W.clear()}}function N(e){if(null!==e.fragment){e.update(),n(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(w)}}const E=new Set;function T(e,t){e&&e.i&&(E.delete(e),e.i(t))}function j(e,t,s,n){if(e&&e.o){if(E.has(e))return;E.add(e),undefined.c.push((()=>{E.delete(e),n&&(s&&e.d(1),n())})),e.o(t)}}function O(e){e&&e.c()}function A(e,s,o,i){const{fragment:c,on_mount:u,on_destroy:l,after_update:a}=e.$$;c&&c.m(s,o),i||w((()=>{const s=u.map(t).filter(r);l?l.push(...s):n(s),e.$$.on_mount=[]})),a.forEach(w)}function B(e,t){const s=e.$$;null!==s.fragment&&(n(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function S(e,t){-1===e.$$.dirty[0]&&(g.push(e),k||(k=!0,y.then(x)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function M(t,r,o,i,c,l,a,f=[-1]){const p=d;b(t);const h=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:c,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:r.context||[]),callbacks:s(),dirty:f,skip_bound:!1,root:r.target||p.$$.root};a&&a(h.root);let g=!1;if(h.ctx=o?o(t,r.props||{},((e,s,...n)=>{const r=n.length?n[0]:s;return h.ctx&&c(h.ctx[e],h.ctx[e]=r)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](r),g&&S(t,e)),s})):[],h.update(),g=!0,n(h.before_update),h.fragment=!!i&&i(h.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);h.fragment&&h.fragment.l(e),e.forEach(u)}else h.fragment&&h.fragment.c();r.intro&&T(t.$$.fragment),A(t,r.target,r.anchor,r.customElement),x()}b(p)}class C{$destroy(){B(this,1),this.$destroy=e}$on(e,t){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function P(e,t){switch(typeof e){case"string":const s=function(e){if(0==e)return 0;if(Number(e))return Number(e);if("true"==e)return!0;if("false"==e)return!1;if("null"==e)return null;if("string"!=typeof e)return e;e.startsWith("%")&&(e=e.split("%"),e=scopes[e[1]][e[2]]);return e}(function(e,t){e.startsWith("-$")&&(e=e.substring(1));if(e.startsWith("$"))return t.hasOwnProperty(e.substring(1))?t[e.substring(1)]:scopes.vars[e.substring(1)];return e}(e,t));return e.startsWith("-$")?-1*s:s;case"undefined":return error("detected undefined value");case"NaN":return error("detected NaN value");default:return e}}function L(){return hash_code++,`@${hash_code}`}function R(e){return e[e.length-1]}function q(e,t={}){if(!e)return error("invalid scope");e=e.slice();for(let s of e)if(s.startsWith("@")){const e=z(s,t);if(e.returned||e.breaked)return e}else{if(s.startsWith("break"))return{breaked:!0};const e=I(s,t);if(s.startsWith("return"))return{returned:!0,value:P(e,t)}}return{}}function z(e,t){const s=globalThis.scopes[e][0];return s.startsWith("while")?function(e,t){let s=scopes[e].slice();s=s.shift()+" ",s="boolean"+s.slice(5,-1);let n=config.max_loop_limit;for(;I(s,t);){const{breaked:s,returned:r,value:o}=q(scopes[e].slice(1),t);if(s)break;if(r)return{returned:r,value:o};if(!n)return error("stack overflow");n--}return{}}(e,t):s.startsWith("loop")?function(e,t){let s=scopes[e].slice();s=s.shift()+" ",s=I("number "+s.slice(4,-1).trim(),t);let n=config.max_loop_limit;for(;s>0;){const{breaked:r,returned:o,value:i}=q(scopes[e].slice(1),t);if(r)break;if(o)return{returned:o,value:i};if(s--,!n)return error("stack overflow");n--}return{}}(e,t):s.startsWith("if")?function(e,t){const s=scopes[e].slice();let n;const r=s.length/2;for(const e of new Array(r)){let e=s.shift();if(e+=" ",e.startsWith("if")){if(e="boolean "+e.slice(2,-1),I(e,t)){n=s.shift();break}}else if(e.startsWith("elseif")){if(e="boolean "+e.slice(6,-1),I(e,t)){n=s.shift();break}}else if(e.startsWith("else")){n=s.shift();break}s.shift()}return n?q(scopes[n],t):{}}(e,t):s.startsWith("try")?function(e,t){const s=scopes[e].slice();let n;globalThis.enable_catch=!0;try{n=q(scopes[s[1]],t)}catch(e){let r=s[2].split(" ")[1];r&&K(r.substring(1),globalThis.currentError,t),n=q(scopes[s[3]],t)}return globalThis.enable_catch=!1,n}(e,t):s.startsWith("switch")?function(e,t){const s=scopes[e],n=I("pass_input "+s.shift().slice(6),t);let r={};for(let e=0;e<s.length;e++){if(s[e].startsWith("default"))e++,r=q(scopes[s[e]],t);else if(s[e].startsWith("case")){const o=I("pass_input "+s[e].slice(4),t);e++,P(n,t)==P(o,t)&&(r=q(scopes[s[e]],t))}else error(`invalid keyword ${s[e]} in switch block`);if(r.breaked)return{value:null};if(r.returned)return r}return{}}(e,t):(error(`invalid block ${s}`),{})}function I(e,t){e=(e=J(e,t)).split(" | ").filter(Boolean).reverse();let s="";for(let n of e)n=n.trim(),n+=` ${s}`,s=D(n,t);return s}function J(e,t,s=[]){if(!e.includes("[")&&!e.includes("]"))return e;let n=0;for(const r of e){if("["==r)s.push(n);else if("]"==r){const r=s.pop();if((e=e.slice(0,r)+I(e.slice(r+1,n),t)+e.slice(n+1,e.length)).includes("]")){e=J(e,t,s);break}break}n++}return e}function D(e,t){return function(e,t,s){switch(t){case"break":return"break";case"return":case"pass_input":return s[0]}switch(t){case"exit":process.exit();case"random":return Math.random()}switch(t){case"log":return log(s.reduce(((t,s)=>t+function(e){return"string"!=typeof e?e:e=e.split("[s]").join(" ")}(P(s,e))),"")),null;case"add":let t=0;return s.some((t=>"number"!=typeof P(t,e)))&&(t=""),s.reduce(((t,s)=>t+P(s,e)),t);case"multiply":return s.reduce(((t,s)=>t*P(s,e)),1);case"divide":return s.reduce(((t,s)=>t/P(s,e)),1)}const n=F(s.shift(),t,e);switch(t){case"boolean":return Boolean(n);case"number":return Number(n);case"not":return!Boolean(n);case"call":const t=[];for(const n of s)t.push(P(n,e));return function(e,t){if(!globalThis.scopes.hasOwnProperty(e))return error(`${e} is not a function`);const s=globalThis.scopes[e].slice();let n=s.shift().split(" ").filter(Boolean);n=n.splice(2);const r={};for(const e of n)r[e.substring(1)]=t.shift();const o=q(s,r);return o.breaked&&error(`invalid break statment in function ${e}`),o}(n,t).value;case"round":return Math.round(n);case"floor":return Math.floor(n);case"new":return function(e){const t=L();switch(e){case"Object":return scopes.object[t]={},`%object%${t}`;case"Array":return scopes.array[t]=[],`%array%${t}`;default:return error(`${e} is not a constructor`)}}(n)}const r=F(s.shift(),t,e,[n]);switch(t){case"get":let o=P(n,e);return o||error(`${n} is not defined (Array/Object)`),o=o.split("%"),scopes[o[1]][o[2]][r];case"set":return Number(n)||0==n?error(`expected Chars got Number ${n}`):(n.startsWith("%")?function(e,t,s){if("array"===(e=e.split("%").filter(Boolean))[0])Number(t)||0==t||error(`expected index to be a number , got ${t}`);scopes[e[0]][e[1]][t]=s}(n,r,F(s.shift(),t,e,[n,r])):K(n,r,e),null);case"pow":return sum=n,Math.pow(n,r);case"reminder":return n%r;case"eq":return n==r;case"gt":return n>r;case"lt":return n<r;case"ge":return n>=r;case"le":return n<=r}error(`invalid command or arg - ${t} with arg ${[n,r,...s]}`)}(t,(e=e.split(" ").filter(Boolean)).shift(),e)}function K(e,t,s){s.hasOwnProperty(e)?s[e]=t:scopes.vars[e]=t}function F(e,t,s,n=[]){return Number(e)||0==e?Number(e):void 0!==e?P(e,s):void error(`invalid command - ${t} with arg ${[e,...n]}`)}function G(e){let t=0,s=!1,n=0;for(const r of e){if("'"==r){if(s){const s=L();let r=e.slice(0,t);return r+=`%string%${s}`,r+=e.slice(n+1,e.length),scopes.string[s]=e.slice(t+1,n).split(" ").join("[s]"),G(r)}t=n,s=!s}n++}return e}function H(e){let t=0;for(;e.startsWith(" ");)t++,e=e.substring(1);return Math.floor(t/config.tab)}const Q=[];const U=function(t,s=e){let n;const r=new Set;function i(e){if(o(t,e)&&(t=e,n)){const e=!Q.length;for(const e of r)e[1](),Q.push(e,t);if(e){for(let e=0;e<Q.length;e+=2)Q[e][0](Q[e+1]);Q.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(o,c=e){const u=[o,c];return r.add(u),1===r.size&&(n=s(i)||e),o(t),()=>{r.delete(u),0===r.size&&(n(),n=null)}}}}("");async function V(e){U.set(""),globalThis.scopes={},globalThis.hash_code=0,scopes.global=[],scopes.vars={},scopes.object={},scopes.array={},scopes.string={},await async function(e,t){let s,n=["global"],r=0,o=!1,i=[],c=!1;for(let u of e){const e=H(u);if(u.includes("#")&&(u.includes("##")&&(o=!o),u=u.split("#")[0]),u=G(u),u=u.trim(),o);else if(u){if(u.startsWith("import "))await t(u.slice(6));else if(r==e)scopes[R(n)].push(u);else if(r>e){for(const t of Array(r-e))n.pop();scopes[R(n)].push(u)}else if(r<e)if(s.startsWith("function")){scopes[R(n)].pop();let e=s.split(" ").filter(Boolean);e=e[1],scopes[e]=[s,u],n.push(e)}else if(s.startsWith("if")){const e=L();scopes[R(n)].pop(),scopes[R(n)].push(e);const t=L();scopes[t]=[u],n.push(t),i.push(e),scopes[e]=[s,t]}else if(s.startsWith("else")){i.length||error(`invalid if block\n${s}`),scopes[R(n)].pop();const e=L();n.push(e),scopes[e]=[u],scopes[R(i)].push(s,e),s.startsWith("elseif")||i.pop()}else if(s.startsWith("while")||s.startsWith("loop")){const e=L();scopes[R(n)].pop(),scopes[R(n)].push(e),scopes[e]=[s,u],n.push(e)}else if(s.startsWith("try")){c=L();const e=L();scopes[R(n)].pop(),scopes[R(n)].push(c),scopes[e]=[u],scopes[c]=[s,e],n.push(e)}else if(s.startsWith("catch")){c||error(`try block not found for ${s}`);const e=L();scopes[c].push(s,e),scopes[R(n)].pop(),scopes[e]=[u],n.pop(),n.push(e),c=null}else if(s.startsWith("switch")){const e=L();scopes[R(n)].pop(),scopes[R(n)].push(e),scopes[e]=[s,u],n.push(e)}else if(s.startsWith("default")||s.startsWith("case")){const e=L();scopes[e]=[u],scopes[R(n)].push(e),n.push(e)}else error(`invalid scope change\n${s}\n${u}`);r=e,s=u}}}(e,X),function(){const{breaked:e}=q(scopes.global,scopes.vars);e&&error("invalid break statment in global scope")}(scopes.global,scopes.vars),console.log(scopes)}function X(e){error(`cannot import file ${e} from online editor`)}function Y(t){let s,r,o,a;return{c(){s=l("main"),r=l("textarea"),p(r,"id","editor"),p(r,"placeholder","Editor"),p(r,"spellcheck","true"),p(r,"contenteditable",""),p(r,"class","svelte-1nj754i"),p(s,"class","svelte-1nj754i")},m(e,n){c(e,s,n),i(s,r),h(r,t[1]),t[4](r),o||(a=[f(r,"input",t[3]),f(r,"keypress",t[2])],o=!0)},p(e,[t]){2&t&&h(r,e[1])},i:e,o:e,d(e){e&&u(s),t[4](null),o=!1,n(a)}}}function Z(e,t,s){let n,r=JSON.parse(localStorage.getItem("text"))||"",o=!1;function i(){o=!1,localStorage.setItem("text",JSON.stringify(r))}return window.addEventListener("keydown",(e=>{if("Tab"===e.code){e.preventDefault();const t=n.selectionStart,o=n.selectionEnd;s(1,r=r.substring(0,t)+"  "+r.substring(o)),n.focus(),s(0,n.selectionEnd=t+2,n)}})),[n,r,function(e){if(o||(o=!0,setTimeout(i,1e3)),"Enter"===e.code)e.ctrlKey&&V(r.split("\n"))},function(){r=this.value,s(1,r)},function(e){m[e?"unshift":"push"]((()=>{n=e,s(0,n)}))}]}globalThis.config={tab:2,max_loop_limit:1e3},globalThis.error=e=>{U.update((t=>t+`[ERROR] ${e}\n`))},globalThis.log=e=>{U.update((t=>t+`${e}\n`))};class ee extends C{constructor(e){super(),M(this,e,Z,Y,o,{})}}function te(t){let s,n,r,o;return{c(){s=l("main"),n=l("textarea"),p(n,"placeholder","Console"),n.readOnly=!0,p(n,"class","svelte-la6hp2"),p(s,"class","svelte-la6hp2")},m(e,u){c(e,s,u),i(s,n),h(n,t[0]),r||(o=f(n,"input",t[1]),r=!0)},p(e,[t]){1&t&&h(n,e[0])},i:e,o:e,d(e){e&&u(s),r=!1,o()}}}function se(e,t,s){let n="";return U.subscribe((e=>{s(0,n=e)})),[n,function(){n=this.value,s(0,n)}]}class ne extends C{constructor(e){super(),M(this,e,se,te,o,{})}}function re(t){let s,n,r,o,f;return n=new ee({}),o=new ne({}),{c(){s=l("main"),O(n.$$.fragment),r=a(),O(o.$$.fragment),p(s,"class","svelte-4x8ejy")},m(e,t){c(e,s,t),A(n,s,null),i(s,r),A(o,s,null),f=!0},p:e,i(e){f||(T(n.$$.fragment,e),T(o.$$.fragment,e),f=!0)},o(e){j(n.$$.fragment,e),j(o.$$.fragment,e),f=!1},d(e){e&&u(s),B(n),B(o)}}}return new class extends C{constructor(e){super(),M(this,e,null,re,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
