var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function s(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function u(e){e.parentNode.removeChild(e)}function l(e){return document.createElement(e)}function a(){return e=" ",document.createTextNode(e);var e}function f(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function p(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function d(e,t){e.value=null==t?"":t}let h;function g(e){h=e}const b=[],m=[],$=[],v=[],y=Promise.resolve();let w=!1;function k(e){$.push(e)}let x=!1;const _=new Set;function W(){if(!x){x=!0;do{for(let e=0;e<b.length;e+=1){const t=b[e];g(t),N(t.$$)}for(g(null),b.length=0;m.length;)m.pop()();for(let e=0;e<$.length;e+=1){const t=$[e];_.has(t)||(_.add(t),t())}$.length=0}while(b.length);for(;v.length;)v.pop()();w=!1,x=!1,_.clear()}}function N(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(k)}}const E=new Set;function j(e,t){e&&e.i&&(E.delete(e),e.i(t))}function O(e,t,n,r){if(e&&e.o){if(E.has(e))return;E.add(e),undefined.c.push((()=>{E.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}function T(e){e&&e.c()}function A(e,n,o,i){const{fragment:c,on_mount:u,on_destroy:l,after_update:a}=e.$$;c&&c.m(n,o),i||k((()=>{const n=u.map(t).filter(s);l?l.push(...n):r(n),e.$$.on_mount=[]})),a.forEach(k)}function B(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function S(e,t){-1===e.$$.dirty[0]&&(b.push(e),w||(w=!0,y.then(W)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function M(t,s,o,i,c,l,a,f=[-1]){const p=h;g(t);const d=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:s.context||[]),callbacks:n(),dirty:f,skip_bound:!1,root:s.target||p.$$.root};a&&a(d.root);let b=!1;if(d.ctx=o?o(t,s.props||{},((e,n,...r)=>{const s=r.length?r[0]:n;return d.ctx&&c(d.ctx[e],d.ctx[e]=s)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](s),b&&S(t,e)),n})):[],d.update(),b=!0,r(d.before_update),d.fragment=!!i&&i(d.ctx),s.target){if(s.hydrate){const e=function(e){return Array.from(e.childNodes)}(s.target);d.fragment&&d.fragment.l(e),e.forEach(u)}else d.fragment&&d.fragment.c();s.intro&&j(t.$$.fragment),A(t,s.target,s.anchor,s.customElement),W()}g(p)}class C{$destroy(){B(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function P(e,t){switch(typeof e){case"string":const n=function(e){if(0==e)return 0;if(Number(e))return Number(e);if("true"==e)return!0;if("false"==e)return!1;if("null"==e)return null;if("string"!=typeof e)return e;e.startsWith("%")&&(e=e.split("%"),e=scopes[e[1]][e[2]]);return e}(function(e,t){e.startsWith("-$")&&(e=e.substring(1));if(e.startsWith("$"))return t.hasOwnProperty(e.substring(1))?t[e.substring(1)]:scopes.vars[e.substring(1)];return e}(e,t));return e.startsWith("-$")?-1*n:n;case"undefined":return error("detected undefined value");case"NaN":return error("detected NaN value");default:return e}}function L(){return hash_code++,`@${hash_code}`}function R(e){return e[e.length-1]}function q(e,t={}){e=e.slice();for(let n of e)if(n.startsWith("@")){const e=z(n,t);if(e.returned||e.breaked)return e}else{if(n.startsWith("break"))return{breaked:!0};const e=I(n,t);if(n.startsWith("return"))return{returned:!0,value:P(e,t)}}return{value:null}}function z(e,t){const n=globalThis.scopes[e][0];return n.startsWith("while")?function(e,t){let n=scopes[e].slice();n=n.shift()+" ",n="boolean"+n.slice(5,-1);let r=config.max_loop_limit;for(;I(n,t);){const{breaked:n,returned:s,value:o}=q(scopes[e].slice(1),t);if(n)break;if(s)return{returned:s,value:o};if(!r)return error("stack overflow");r--}return{}}(e,t):n.startsWith("loop")?function(e,t){let n=scopes[e].slice();n=n.shift()+" ",n=I("number "+n.slice(4,-1).trim(),t);let r=config.max_loop_limit;for(;n>0;){const{breaked:s,returned:o,value:i}=q(scopes[e].slice(1),t);if(s)break;if(o)return{returned:o,value:i};if(n--,!r)return error("stack overflow");r--}return{}}(e,t):n.startsWith("if")?function(e,t){const n=scopes[e].slice();let r;const s=n.length/2;for(const e of new Array(s)){let e=n.shift();if(e+=" ",e.startsWith("if")){if(e="boolean "+e.slice(2,-1),I(e,t)){r=n.shift();break}}else if(e.startsWith("elseif")){if(e="boolean "+e.slice(6,-1),I(e,t)){r=n.shift();break}}else if(e.startsWith("else")){r=n.shift();break}n.shift()}return r?q(scopes[r],t):{}}(e,t):{value:null}}function I(e,t){e=(e=J(e,t)).split(" | ").filter(Boolean).reverse();let n="";for(let r of e)r=r.trim(),r+=` ${n}`,n=D(r,t);return n}function J(e,t,n=[]){if(!e.includes("[")&&!e.includes("]"))return e;let r=0;for(const s of e){if("["==s)n.push(r);else if("]"==s){const s=n.pop();if((e=e.slice(0,s)+I(e.slice(s+1,r),t)+e.slice(r+1,e.length)).includes("]")){e=J(e,t,n);break}break}r++}return e}function D(e,t){return function(e,t,n){switch(t){case"break":return"break";case"return":return n[0]}switch(t){case"exit":process.exit();case"random":return Math.random()}switch(t){case"log":return log(n.reduce(((t,n)=>t+function(e){return"string"!=typeof e?e:e=e.split("[s]").join(" ")}(P(n,e))),"")),null;case"add":let t=0;return n.some((t=>"number"!=typeof P(t,e)))&&(t=""),n.reduce(((t,n)=>t+P(n,e)),t);case"multiply":return n.reduce(((t,n)=>t*P(n,e)),1);case"divide":return n.reduce(((t,n)=>t/P(n,e)),1)}const r=K(n.shift(),t,e);switch(t){case"boolean":return Boolean(r);case"number":return Number(r);case"not":return!Boolean(r);case"call":const t=[];for(const r of n)t.push(P(r,e));return function(e,t){if(!globalThis.scopes.hasOwnProperty(e))return error(`${e} is not a function`);const n=globalThis.scopes[e].slice();let r=n.shift().split(" ").filter(Boolean);r=r.splice(2);const s={};for(const e of r)s[e.substring(1)]=t.shift();const o=q(n,s);return o.breaked&&error(`invalid break statment in function ${e}`),o}(r,t).value;case"round":return Math.round(r);case"floor":return Math.floor(r);case"new":return function(e,t){const n=L();switch(e){case"Object":return scopes.object[n]={},`%object%${n}`;case"Array":return scopes.array[n]=[],`%array%${n}`;default:return error(`${e} is not a constructor`)}}(r)}const s=K(n.shift(),t,e,[r]);switch(t){case"get":let o=P(r,e);return o||error(`${r} is not defined (Array/Object)`),o=o.split("%"),scopes[o[1]][o[2]][s];case"set":return Number(r)||0==r?error(`expected Chars got Number ${r}`):(r.startsWith("%")?function(e,t,n){if("array"===(e=e.split("%").filter(Boolean))[0])Number(t)||0==t||error(`expected index to be a number , got ${t}`);scopes[e[0]][e[1]][t]=n}(r,s,K(n.shift(),t,e,[r,s])):function(e,t,n){n.hasOwnProperty(e)?n[e]=t:scopes.vars[e]=t}(r,s,e),null);case"pow":return sum=r,Math.pow(r,s);case"reminder":return r%s;case"eq":return r==s;case"gt":return r>s;case"lt":return r<s;case"ge":return r>=s;case"le":return r<=s}error(`invalid command or arg - ${t} with arg ${[r,s,...n]}`)}(t,(e=e.split(" ").filter(Boolean)).shift(),e)}function K(e,t,n,r=[]){return Number(e)||0==e?Number(e):void 0!==e?P(e,n):void error(`invalid command - ${t} with arg ${[e,...r]}`)}function F(e){let t=0,n=!1,r=0;for(const s of e){if("'"==s){if(n){const n=L();let s=e.slice(0,t);return s+=`%string%${n}`,s+=e.slice(r+1,e.length),scopes.string[n]=e.slice(t+1,r).split(" ").join("[s]"),F(s)}t=r,n=!n}r++}return e}function G(e){let t=0;for(;e.startsWith(" ");)t++,e=e.substring(1);return Math.floor(t/config.tab)}const H=[];const Q=function(t,n=e){let r;const s=new Set;function i(e){if(o(t,e)&&(t=e,r)){const e=!H.length;for(const e of s)e[1](),H.push(e,t);if(e){for(let e=0;e<H.length;e+=2)H[e][0](H[e+1]);H.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(o,c=e){const u=[o,c];return s.add(u),1===s.size&&(r=n(i)||e),o(t),()=>{s.delete(u),0===s.size&&(r(),r=null)}}}}("");async function U(e){Q.set(""),globalThis.scopes={},globalThis.hash_code=0,scopes.global=[],scopes.vars={},scopes.object={},scopes.array={},scopes.string={},await async function(e,t){let n,r=["global"],s=0,o=null,i=!1;for(let c of e){const e=G(c);if(c.includes("#")&&(c.includes("##")&&(i=!i),c=c.split("#")[0]),c=F(c),c=c.trim(),i);else if(c){if(c.startsWith("import "))await t(c.slice(6));else if(s==e)scopes[R(r)].push(c);else if(s>e){for(const t of Array(s-e))r.pop();scopes[R(r)].push(c)}else if(s<e)if(n.startsWith("function")){scopes[R(r)].pop();let e=n.split(" ").filter(Boolean);e=e[1],scopes[e]=[n,c],r.push(e)}else if(n.startsWith("if")){const e=L();scopes[R(r)].pop(),scopes[R(r)].push(`${e}`);const t=L();scopes[t]=[c],r.push(t),o=e,scopes[e]=[n,t]}else if(n.startsWith("else")){o||error(`invalid if statment - ${n}`),scopes[R(r)].pop();const e=L();r.push(e),scopes[e]=[c],scopes[o].push(n,e),n.startsWith("elseif")||(o=null)}else if(n.startsWith("while")||n.startsWith("loop")){const e=L();scopes[R(r)].pop(),scopes[R(r)].push(`${e}`),scopes[e]=[n,c],r.push(e)}else error(`invalid scope change\n${n}\n  ${c}`);s=e,n=c}}}(e,V),function(){const{breaked:e}=q(scopes.global,scopes.vars);e&&error("invalid break statment in global scope")}(scopes.global,scopes.vars),console.log(scopes)}function V(e){error(`cannot import file ${e} from online editor`)}function X(t){let n,s,o,a;return{c(){n=l("main"),s=l("textarea"),p(s,"id","editor"),p(s,"placeholder","Editor"),p(s,"spellcheck","true"),p(s,"contenteditable",""),p(s,"class","svelte-1nj754i"),p(n,"class","svelte-1nj754i")},m(e,r){c(e,n,r),i(n,s),d(s,t[1]),t[4](s),o||(a=[f(s,"input",t[3]),f(s,"keypress",t[2])],o=!0)},p(e,[t]){2&t&&d(s,e[1])},i:e,o:e,d(e){e&&u(n),t[4](null),o=!1,r(a)}}}function Y(e,t,n){let r,s=JSON.parse(localStorage.getItem("text"))||"",o=!1;function i(){o=!1,localStorage.setItem("text",JSON.stringify(s))}return window.addEventListener("keydown",(e=>{if("Tab"===e.code){e.preventDefault();const t=r.selectionStart,o=r.selectionEnd;n(1,s=s.substring(0,t)+"  "+s.substring(o)),r.focus(),n(0,r.selectionEnd=t+2,r)}})),[r,s,function(e){if(o||(o=!0,setTimeout(i,1e3)),"Enter"===e.code)e.ctrlKey&&U(s.split("\n"))},function(){s=this.value,n(1,s)},function(e){m[e?"unshift":"push"]((()=>{r=e,n(0,r)}))}]}globalThis.config={tab:2,max_loop_limit:1e3},globalThis.error=e=>{Q.update((t=>t+`[ERROR] ${e}\n`))},globalThis.log=e=>{Q.update((t=>t+`${e}\n`))};class Z extends C{constructor(e){super(),M(this,e,Y,X,o,{})}}function ee(t){let n,r,s,o;return{c(){n=l("main"),r=l("textarea"),p(r,"placeholder","Console"),r.readOnly=!0,p(r,"class","svelte-la6hp2"),p(n,"class","svelte-la6hp2")},m(e,u){c(e,n,u),i(n,r),d(r,t[0]),s||(o=f(r,"input",t[1]),s=!0)},p(e,[t]){1&t&&d(r,e[0])},i:e,o:e,d(e){e&&u(n),s=!1,o()}}}function te(e,t,n){let r="";return Q.subscribe((e=>{n(0,r=e)})),[r,function(){r=this.value,n(0,r)}]}class ne extends C{constructor(e){super(),M(this,e,te,ee,o,{})}}function re(t){let n,r,s,o,f;return r=new Z({}),o=new ne({}),{c(){n=l("main"),T(r.$$.fragment),s=a(),T(o.$$.fragment),p(n,"class","svelte-4x8ejy")},m(e,t){c(e,n,t),A(r,n,null),i(n,s),A(o,n,null),f=!0},p:e,i(e){f||(j(r.$$.fragment,e),j(o.$$.fragment,e),f=!0)},o(e){O(r.$$.fragment,e),O(o.$$.fragment,e),f=!1},d(e){e&&u(n),B(r),B(o)}}}return new class extends C{constructor(e){super(),M(this,e,null,re,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
